# M = 128
N = 1275
t = 5
n = int(N / t)
R_F = 8
R_P = 57
prime = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001
F = GF(prime)

round_constants = ['0x53783d37a24409bbc3c80009bea6395f1d70f6e34b9a8e546a46f481a1b3b06a', '0x3044ff0bbd8b00c8e369c8ffb572d87643541dc57e4f5e79bc6a9407ed150de6', '0x12a767e1ac4c20db0adec8d0dcb9d4ed30a9b94593228eabc045c7703a7db06e', '0x2083f57bf62382dcd0b82983d92554677dae5d1ceaed8639a39043b203b16fc6', '0x35e0eaf77b63cf3499fe237947c538990e22994562146ccb2cc8b2425ce825e7', '0x1e2b0d627a1872f064ee93846a6e4cf394f16f4cae917d401e95ee169fa0e1d4', '0x21769ae0c072b6c0329c22eaa11f9fa4a88e65dd9c1a6f75cd9130b98b6d3f79', '0x34666d8c315b7e58a2b3fb6d887b152b5bc133149a9c0172726f245a2af7ec75', '0x02cafbe35931b7abd8fcca99a2cb2d88b2e5caaf0a5efbf46ac089e93aad3b5d', '0x201a03372d133ac2156fba96f86ee026d2c9c0a73bad78953b55d8323e7afcd2', '0x52e8aecb11e2613a43c89f1eff53c05566feb9d86e5e9efbbb9db168c9a775be', '0x730adde97fea81c70b1bde3a47f23f1a266cb26a771c6ddac5cf16e07b800ecd', '0x4d4b0eb66d10afe70c09e649cfc3baf050742b896fd6fdd1d241221c5e720166', '0x5d91620a43f78b5d411f21e857ee221661974728c9d30d2af56dc143a58313c2', '0x19e73abfb5aeff0b36aed9b2242e2f31bbc54abf7d8b6573617f2700869289fb', '0x460c74859f35cea4ef979f3b2313f6d24416bfcbe15f05a0dc4af82ffb91ce5d', '0x15917cd3a2ccffdedb810fd54325562ba5ee8215982fd3e7be033b39b2854d92', '0x07eb3bb31a973cd7b51d7e512a91ee9334cb37e4aae18303d62573fb461db120', '0x3eb1606b3db22f1ad41a19642600beb787a8d7a8c9f7196314a86c9c87da3bb9', '0x0483be25e0f5d0b58205479816467959beb0d2f32627693df49911c114f37f62', '0x58734531a575dffffece98c9e454a8c2909f0231a0bfda64e6147e5aa0526fdc', '0x4cf043b2e24d527be94001eb1b290cc229bd12cbf7ec2727236355a193be9f61', '0x6d551793306004ea5718aa39ba7189ef51c10a3dffc3c15692c2ee2e988f20d0', '0x662bcaeee9b85f1dbf9b05168e20d738324f756940731a2cb2bc3e21404f3613', '0x6a6b4ce4d8a9ff5cf3f4afbd2d8e40ce675b57f94ef1b2c4d1e10c8dd37f9a3a', '0x37161448e5ca8b077e626b6fef614a88394a27271e2a0ffb906377dbf847e60c', '0x36d0f0dd3092145a363dd487b36cac331aff8fe265242a6dfd7e04a5e9bb7bff', '0x32a083edac3d1a402ab07806945df03fbae9e3fbacb6462c66dcdf6314187d08', '0x4bce60a9acefd6d686eb5de1e218203ea6675265af6a203550d96f2042f49354', '0x14686a770e3eba4b10e7630e759f8d6305299f37ee4240f6e290713c92ac8e01', '0x5009e41c7ea3818bc6b87510ae767b145c1272bd9575987b7cdc6d193ff5a5b4', '0x094e125a85a857be60b1cf8cdeeb10def9b9c25dcae6e18357efdf1935d1f79e', '0x5924792f671a97ae439fdcd22f78a6d174f2462fa67ce84a710f5042f2e13a00', '0x45b8b173b7bed492ff52ee710ca89c3123484c8b2221516bcf9afbdb6835893f', '0x013c0a9d2f3bee3c5dc6560970cb1dab2156e2f65b634b44cd5d97cecd282cab', '0x5220641347643817164d13424289fa7a14ffe62d093f1608db620afdabad14b1', '0x69c2155244a7a6e77d98bd1d5b6268bc15c6a1183f1483bac3670740c6db449a', '0x5678942d819b17795e0e886c0bb8aa216a5031c61e107f2ba26c9bfd9f0dee0b', '0x67c078b32900fee444eacba883bdd87961ef68d4dee0a0c8e7cf79b9de22cbf6', '0x53d0cff1309df9c57ec9181680de2725725338a96b77215ace409f8335357c0f', '0x6fc4e28462ad07e93582789a8ba7c231a632a54ecc42b70b9ac0dc05b2d9b793', '0x0105a18e7918eec67d49bd7909e4fbb8be9599541e41fe9d0a8dedb68bf99a99', '0x5c10fd30ff6ff8f952c04e933f6764262a41d685774b742c13b1b7a66c24370b', '0x0696df9a066a8275a6d19401aa99169a80adc47f5d93186c141727609bcafd43', '0x6cc14b97e278c3b3249e4e681366d11af6512fbeb1e1031f9d42866e2967dcbf', '0x55f5ac1f945f69c05efe989dc5bec77b4e173ede4071d0a00fda4a736b76e08c', '0x6680ab73fa6a5bb1aaabe0596955396fdae64e2ca85b28d48e52dfb4fd9b6408', '0x4a256a8c2a89a4dbb5f70cf35d4798dced7195ff322617ca9406b71b2700606b', '0x4bcf3d9b27d03b5e0d3bfe334d0150e98fe4d7ed4bee80995c7ddecac4a3cf7d', '0x6b4f9873bc2be852a951406b05318553b46f6546961682abd3d0c2bbd7891e6f', '0x4ddef58769acf487ca68da9429ee8e53aa57ea32c4f5df4bcd562f3bd92fb9b1', '0x2f32922cbc4dc3bf4d75c5de6b010670558ce640059a98df1661400ded226460', '0x5bd8fdd6c97aeed78a5a1742ace2d43a648b7a7b89792af517452e0ea06856bf', '0x0eb24adfababef785eb8f850488344427e3d04b7ca10490f48fd756bf4154441', '0x3fb6283b50d04c21241bf53a5865c10317b8e17ac7b30918b8ea98a0bec4e385', '0x63640439de42b7e02410a6080146ee16a21cfde8fd2cfebca2a9f397a92c3ac6', '0x53de44799eb1eea56cfe1a8c650e90ac255ce17f1a30e09bb36a16ef4d2ab97e', '0x04ad6999f5a553f04aa019e22f8fb8de758d669d4a2d107e81501086d23765e7', '0x2e0a83a08fe4132fac34e6383c495c4502ae76cf6bd9917b2a7f19d7d3943421', '0x7303f250fafe419b74343245db777cb9f94cc0bcde6116465b4aed22e7aea098', '0x2160d8c48371d0acc3e284173c1f935da71d3b88f65d9bea03757894c9d5fec0', '0x70d4619d76f2c2e9b09749dca91199c5634fb4fcc506f800201a0d17ddd50712', '0x57e2bce096e825aacafb3555ff326343c98606d78d1b094a2c923f487024b932', '0x6f02a21a1fbe0899a8bc4f7c909711d780027d89bafacd40aa1fb2ab5bdd1230', '0x54232c8262f6c55cdf785c076e7ef36f1514bf4f3ab5f1ee7e5ff598e52bbe28', '0x3bafd4e02b887bfb27ae1b993a9d94e0670b736833e3a5a0bc3d4a48ca05aae9', '0x5bd9ce5ae0cf1406f8bf4a287cb5def5787693aeb1e75cc685d02b1f9b0264b0', '0x55382e2faae1715dcbbcaf54b19de39ad50bba3a3e1e8c996db4a5fd66793c9c', '0x48dbb6456dc217eb7602e559453916b4c39030a2582087a57846e8367638e685', '0x1ac298776e1a3841cade78ae7cf49d7d682a56ec1dafc411c8c2131d1788f44c', '0x658a55fe14226c2d6f64f5916ecbd7dab828687e0ecedff0ddba1ccbf9cd51c0', '0x58200447b2941181db67f000e4a5caf76801dcfae8d2437b4622ca9ea22775ae', '0x0a3a7519c001677b7eff7af47c383d616bd57104e4a4edf5d53b82154146209d', '0x296ede3dc4e426cca886bb7abcab0194a2312addecc6a4dc82a9edbf26105398', '0x372687f9432986ea35ac0121b2f556e87e554a1e4805ee2da8071c8e14979895', '0x6685dfebd204296cd57af10fa6a5dbafbd13ac12a8805808c36fd75ef9bf9d5b', '0x294a0254a635f4238183b30184fcae79b134b2568fc1dd626f63eef93ccd1259', '0x3a74d5139675ee0c5fe8bb0ca0f050d63764256d92ca92214311d2866e1c35d2', '0x4fa231862fb9d7aed5aeb1fad1249f7b8ff9dc2c3aa15c644050ccb84681b478', '0x6bc3bca441d01f5a41030b4cd6c7eb27ee6f396f49cd0203808715c69a16b701', '0x1b28692458ab0920d0292012e676f368d5b107823a6cc5693363b5d32a707f89', '0x68688f52d97ec3b0915344c66b7972d5cfe935ae9f2bd73f3a38808de858adc2', '0x16b1d3349939f34bdd466f1a35bb80c39ccab39f8a1cb208e518027f1803aa11', '0x0cdcee1924da3627287783fb15ec138c5a29955a0722290c37048b5a8035e96c', '0x020375123c8a3414b8e8d130c1c8a5726505b2aaa6eca3b55d64814e69b976b7', '0x5696cdc1945b5c48874dda2ddba833894c5ee3c55dc572d9056764e3e02efbdb', '0x34e93f21a4973646290cbf2e5fbfde7bf9c6a8cbf962ed571887f8965aa504a8', '0x4b882b0f58087e83b697085f59b94320ddb55d2e7d885208e80d01694ad505b3', '0x4984dd0de99a14486990cfceca5c14dbeff23e56200f82b8aad52f6c9f95621f', '0x2fb5f52fc18337aa1a7023abb8a581fa52b79b2bebb257c0b36f02fcb97e36ae', '0x3e5f6f47a287771afeb0bbf9889ee3ebabc5782046ae000b5799a2b43e5b6031', '0x4e85cf830f55f1e2d96c1701043b5a9117ba383a1dd0b8ab807375f1cb37d76b', '0x10e2cd10bd857e5b5b95747994f14d60b4f69ec11d999238bd1089e8b6d52b9c', '0x1d903f874637830ea5a1a6d75c4f669c0a9f659c0641cc86c159d6668d777d5b', '0x64e982f07d2a35314ac1a0a10991bed59ef6e5f46626f13b498d97001c294610', '0x2a98f0c054b4704c488d749399a6dd537154fd8256845132b737f9e4dadb57dd', '0x49395b8f555de60746d3c60e3a8bd17b559038b71696410023d5b13f8b95502d', '0x6cbe53d3c93451ae7143e8b699c692216aa7d3f29bcf7ea0b447867d74874162', '0x05d0e8b7b7ed37111138849fe21f1a430265cc091e28be04973855ae1174710e', '0x68d636e7dece147db2fccbdfb72cf42e96cd9bef9cdbf29e0262c0649e0d9355', '0x08526c4836baf19c6a58f832d50206c92411f841466388cf1d3eae8adbc63499', '0x4311562a7e08b2a4512893afaee371adf3fbb85e225e16f2b7ce1bb8662671e4', '0x392f0a96f1a9775277b06403218c79430f3aec561f930648ba9034532b4e40f8', '0x126c307a912bf894733d5668caf160581974adb0e01cf779a1de8b93f9e1f36b', '0x09938b599f686d2a419c1557cb74f3a8d538c4e8d27f858e9447e0554a4a5acb', '0x3b21611a2275574e1980dc99450f714a72bba6f2611e522818179854c3bf4777', '0x39cd5f560a081e23d465c8ccb98b42179818fcdb55e5ce4d758f43dd8b1a4c4a', '0x28c6efbab3bce960f8bf70741d8d3d217753962215f8b38a6930f5cd3307350c', '0x3da9e3e6acafa8113fc95ab7f766deae92bdb05ebf1ef1aa731b5e4b99a39108', '0x0c5bd70075fcfff98ba8f43ffb13d1ca4b5354b38ff3820b062abbbd78c24c9f', '0x05344de895561b767af023f1b935041d5a0bc0e61131ab38e8fd89095a39afad', '0x3d8ed0ab1bd2cca400f464a0eaad4a181be2b6967933826281013e561cce43d3', '0x3238c4d0c6b51fbee82b5e4283e4a24432345395d594ef9aec7645c8421d8783', '0x66bf64e5f4b39c1a7e3fc8cca6b2c3b08f3a8e7c2c9cb694145d0db9a38a478c', '0x106c8327ec46d629de3138cd881ba3271f75106c6de16c9b364e8d475fbc227c', '0x043fc9995fb2d9f189e4299523b4ed7b3ac8ee9f41b9f37d1afcbaedbd4c4f84', '0x2ea53c56aa3a5fe83a8f6b22027f3613d40f5680df7f5ccb48ee371717bcbb44', '0x24c1f9d3a3324bd444c73d1e9da083321bf92894f2429a916e0cca45c6f38136', '0x378ec5f5fbfa73cb59d3eddcb13753bd3655a91059f7952092d4b743045d0698', '0x5c88c4b382ddec8b2d5fa6a32e79036083db144de06f1bd1731cab0f5187d491', '0x5010b8af58155539b990e33d42b9a9948c2ce90ff5bf93200234ced313cc3802', '0x16e940131c07b0d1baa0f989965e59bcd994bf5a0d4e7ee05957dafbc5539eb3', '0x6b6f85dab148123a98b6f7c27ac4100628e02a91f3d1a18863a9333a8c4e2804', '0x72e5ec5b632ad9b335ea4cd7ba5dd10d3f795c7c3de5ad4e47da1ad5dbe6ea56', '0x1295069454774e7ebedf841065820ffc8872baca0cd340515aba04d0ef39266c', '0x465f00238cd203476e0beada374e2a1d1a487e767d4f41b9183892e84c2fa309', '0x37a196781f63040ac4d151c768e3a1f0d89ae36a8f706c5b05c383773cfddd72', '0x103b9c0f7e578c9cdf3466ea5f6a51baff564082911c0c2411c4e8e4b730bfbe', '0x2438c2387d59b115b0ec005005384cdd97a29e09ae46a70adcf48ac5537510ff', '0x19fb31ff2ec85cc0192f10243ced99b289af673d1695bce2f9bd268a37696e73', '0x53e25dd37ef883b6c72f374ec0d65af8e2f75230663d797e4e80637e20bfedc9', '0x4dfe21a29efac379e0f0611cc4ff8c3e8cb1598958c9b8e49c9d0d901b8057ab', '0x10372912e40cf91d46c2a8ec951a4504f4cae390594debabfb3523cca49703b6', '0x32f8b2043043b4e7e04a5d88f79a56ad6d77f64a0fdaedefa4d6c4c28b34b7eb', '0x150cf4d92474cea4586afd181d4ba548e2ac9e81907b66d55d8fbd516362f458', '0x70062ff3d08610f1404bf5715a9010419e14a2ab88fbc4e82352e99698b36dfb', '0x428b83b6e12dafdeb18f64110cc513ae5f89ac1128dc838d28c3d8d8f1ce790f', '0x31ac24163f0d7b34e8521e124634ed38d7d341bf3574af2cb8b927087dffea87', '0x33d3511eae159609e362f366ebfaeb9ebd0c2452485763a6b9d220d68a868c6e', '0x40459d4252e501a4596c80f1f7459e26cec0c62ce88b813fde5dbab8c1b68d6e', '0x58dda4a035b3cd55707fed87199a952d08c9c653ad8474bb096b09a378524ffc', '0x25d47788a36325890bf22da33f03aec2d5a9f80c29685051cfc872b2c7451b59',
    '0x5d0f587105749c8875c7c81e72a7ba5b190988ad6f48ccab5b10cebfba008a24', '0x522faa93492053e43bc54cb61edeca18e5a49e1d67a1e67cb07345f28cd8e315', '0x3b71d72841400f8a88ca98cbb6a94d4b030d23111a587a12dd6b3ae8f428ebcb', '0x5c66300f393f4a3f7ba486939192a2e7171b701c9a4f12639ec4b287e4cda501', '0x6f2cd5697b00f7ed909fee98af32e646d607d50e229ab469c3ebcf2c1169e23b', '0x4402f14c5bee02e53091cf606d01a63f0cf4049790dc614dd4a8f4da2af63f9f', '0x5beb01f12bfdcab2669750bd1db419d44f31f91a3eaad4ba2521a075ad9e8682', '0x23471688dcd150cab1b3e64742c78064f4e537d9a197d9ae1fc1f60524b29f36', '0x50003865d12d3d273cea49e01b9d96cf4bf9c8b3c0ca4cb98fc0056acff50c91', '0x560127fc3ea8ffe101814f7a091d06050f3a0348368543916d87674172b7e580', '0x64b298bb3d05853258d8ff35fbb4bd5a83568882ed7d40751ccc8b52b64867ac', '0x28d607d3177accb3177d53946c85c8579410968f65b0c79de0fd9582a0ea4552', '0x4e4447b070706738261f47b3512520b082d918cb4287109b9b5dda6b9146f754', '0x2b48ce829b48d4cfaf81baea547c571de46700316d649e1ea91f4057597cfc95', '0x58179485b6c04ea2b7a04f95820a16bc6363c84c029b869c6f1191a4ee2190b1', '0x3c1c99779e72f589f9ed79a7adf07fd88fcf722151ba05f29ba79fcd03792e02', '0x2b82612b418fb3249dfb45b1fe92dcf0c40dec8cade6812d52afb9269d5e65f7', '0x08327a0c0993dc1c1b804adb8455a9e56b25b14285ed77d1504983d373daeb7d', '0x6900ca2a76e88fe17ea93bb3a3831134ede77811adaf70ef27edf9f4ba562f6f', '0x22fa8b05593b1cd027371d905e5d12fe1dc42131eeff4495796da279035193ea', '0x44c24e060e7c772a43d78153aceb750b77d070818cb43fba29e211c14217695f', '0x450cde38e3c16f6adb86a63ac9f4d09e0b3fca721b7b0d5abba7a302bf9c8623', '0x556b83f811523e8562ff94fa832012104c56b9ff0390f28a73323afc0fb1371d', '0x0c4e317fd002d5ef04cb871164b9d014a3c434550b636492e493937a91bc24be', '0x4f947ce7fa9b91cf393d42f4ff76c872c765d58a4053967c1eb3514aa60e2e17', '0x6abbac09bcf607545bdda6c8f08c9ff2db07ac78c366c15537af610ddc1e5007', '0x1ee02fa53cbff0355cacc4a7ec1adaf3f8490560eb917b8a2a5ae13fe89f0084', '0x03717b62d8b7101a72708ee402749d69febb7e431145809abf5676add5172415', '0x1dee20dae9e83491dba5ecf05af267dd691ee830e9e8fefe24a943f855d65d66', '0x4431c6eda95a6a17ec7ab51e0bd5daf78fda1f989a503c9028cbe80563385ff6', '0x4a4ff68c46726f296677f824e5e7438be1265f952ca1251af3d6d50cf0be754f', '0x6409397b27867d63c549b2d774d3409b31fe6a9c4731a5f437951c6aba03dade', '0x131f0204815815512ae694cdeb8cef9b1df37118fa13e7af302c8136c70721b6', '0x5d9b894f0b4dca894e0029e21f22fd8293c46441673d86128193f4895e4ff880', '0x11f9f4a3b38c0779feb86d9eb40a93a08ee30febc3de067bff739ed9538ce9e7', '0x55ead73b1769883ede4757e881cee8ada55d1585d9db05611078b8c94d6acf19', '0x1b88fae0821d35d701687f7768ff6ee7017ad1b5955609dfb4147795be3a43fc', '0x2d4b890d4190b320854e79594a75c3d6e2398b8626e6eb5e780a851fef0a13a1', '0x0de76636f558c510fa8fadb2591a10ed676919da73186d330155dafb91a3dcde', '0x0b858e8d87f698024e2918b87e2d4975c015f2271587f37d05fccc384d6aca5d', '0x2fcbf45869b00620b71a82836d98d27f74af8acfcd125ea3fb36ac43a9b3ac6e', '0x435786ec4efd989ec2e25f0f61810712a5636092fb7e11b1a8a5b2ebb8595c9e', '0x58bb3d9bb960257eb397c36db7eebe25347712fbdc80021b39e7bd7767849448', '0x10339041791f79b95d5ae82f3ccbb108c2b2fc5eea3feea0a2c9c85f461750d0', '0x5fd28666c267c8e846962480b0c4bcf199f0fa645ed3f7985bffce1d5b8a6ceb', '0x6adcafe7a9a31840e1739936e8592aeb6fcbff368bb0512fd26a392884260f5a', '0x3ad0e59ce26e1c67e220927e597236d89dadb745ffb62da571ccfda751f26e61', '0x649d1f46487ef464f7ed2865bbc05fd85dab19df1881c90ec7bdecda5b3d2e1e', '0x4041fc78100f5c09100edd88284f2d31fcacad63a0dfe71a39d06caa1eb8e1de', '0x564d18a70d6d1cfae14f8daf610106b36102f19d6c7fe9ea0728f7bde3a831fa', '0x401e886748cfc3592aaaf5e7f5ec890abb79844cb44660cbc55bc450a456ba7e', '0x6c0c028913e8e8bb66eadd1fb6feae3ecbec9eb04d5f3fdbba86c73838e2558d', '0x2e1c2cfa1868c2096eae86cdcd938ae3a600da5df5e7badbc79f55c6d05b4c26', '0x520cce04812d8869969f1526b96a2fb3df45ee4547cd28f3f44866f6a52a11a7', '0x6bfb37a446fb4142f47c7da9ca70db0f5b9f16cfa9fada0442e72846644e8c30', '0x4dc67850a191dee583f207cfbbb3f85e24fcd704781ab2d179d41a4b93cc9527', '0x1d68cd42f3172abb06df15ab3c9f976ed9663ec0d910bcf39fabc4588a1ad4dc', '0x17c46eb6b9e0981e8911aed32e71809fefe8bdc11e04feaad8f65cf43833878b', '0x4240098f13371919e6ca8d258f238347f3486c2cf332a5da70789b8e434f95ac', '0x25a0624930b7674937c81b7b2fcbce211ed1e0a7e7e481a2a56c26c3e702a04a', '0x0b7cc85d5b8d256b6c0ccb647216b13a621be0d1706b449988c9dbd7e5c7c974', '0x0457ccd55d6bf71aa787949d04a68d8e973df4ebff5244a54311d60544bc7ef0', '0x1b3da3e75f55aad517987b37bf16393ab85fb72a164246cbbbb75cc74f34623f', '0x25c69ed0578b2a3a0ceed4951bf13f6bfd0550f7a276463d00eef32ee1f9383f', '0x0167eda3e48ec785ac850c03de7792063ea77ab189b8a79b63a81667ca68db3b', '0x01047d2c15013fa4180a02312d921d59085bfcfc1cb473ee932f7e1b5e99975f', '0x72d15b81df8657255fc2ed11258887c65e3c9d2dca2c8e92c725f5d936a4f141', '0x64075511e00493272adcf141248f4410efbc2ff95f9204f356b1b8f431b67873', '0x25e491b05bfab4dc25c0904242cb4135ea2ef334aa2907acaff925df95f89227', '0x27e3c6b4378e8556b0406fe68b30939615d2d63a334f40f4c70d206005751279', '0x087305dcd3e98f14be24911c13214c8097bdf1153ecbb584325713ae55183f08', '0x7232ba10faed8d3afd21cc8c2be609e64b46e8ef45d3ae39680c114f6a26b48b', '0x632e97e3f50cc45a8830377ca1aa51946054772d34e9bf3fd4302a9df24f7b78', '0x5d76fe5766552d0988451800005ede030ab347e7e3f34b1595a46aaa39bf670b', '0x6ff68cc759d2ce943838943d087f60ecd48fd579999230b361a0fb4884b4a7e7', '0x4f73b2d80cdf195ade34f7b94744de624555edb96a9c04df1bef352f62aa7c38', '0x2df191967c15ae34538fd705d0fe88006e2b71df46cb7a4d71968c86675b3f5d', '0x4f11b5056e9b733351332d32dcb6e848761bea70b3a46ba14ff4e018798907f1', '0x2f7d95a58b70fbc94c1b8e70829191b6abbe76f9cfb5245d7f9dd37e4584240f', '0x24a9f013631a90276e79906dbea351d732dbc82d3c16e5052db0b9f36cb24076', '0x07a875deb2ee46cdd40733efad5b762aa19fe179202371fe33d737a1368dfb00', '0x410234e96eec1f476b26568587ace454345f3b9bb7dd3ee4fd657044b2d46768', '0x45fb65ea46c4a4bff1d24d5c3cd47a830b8bd328eb984f86714434fb0a1f6521', '0x4c363f420e8db70ff847403bd8d69e4567dedd8fab4e33f0e11f42600c51d6c0', '0x3fdbf70571c9e41702a29d914c9b40ed6f8eb4ba61bb2a448342048368004c23', '0x0c09fb80279a9d6c33ba2d6fcad513e47204b5f1640bcaab3d8b31ed475aeebc', '0x302587512ded704e834d665bd53a14cc3b0a0322fb13e51233a254e0cfa7ee8f', '0x6ca85c301bacfd54302a1cf5ca4f4c220d879991bf49c24d8923cda7ca846799', '0x1257d3bbb78bec686416ac3d3c754c25c689706196eef26b99b2d5fd7d294ef0', '0x2e0e4a59a5b14fb6213bce052354ade65be2749edefe357c6e4ee6ac03439bc7', '0x1fd209978b9cc174887f7fe05f7367eed94b3cd59220ec672bb4b7e8d78c4266', '0x5628697a31e098c92bc68986600defdbd227906d3c24ec3e10f07a5cc81b1677', '0x53eee6f38314169891df48e229a4c7e13175adf0aedd7736438e063f2ecda4ca', '0x095cdb4c1721913680f0f090b33a50da55ceea49308554d38e9549c850e45b4e', '0x46d1e3174e5c7dfa1cb5b9787e7c59e095c7f404657c76cbebb63e2c90486854', '0x0abcb15a6cddb5a9df97d4aca420583f2fca722e74280331d0fb39aba06f027d', '0x373d5db381a468b93985c81b800378e9cc1a3cb567cfc894d244f0e485bca792', '0x653af3cac25d575290bb4b26321414bbb41738e9dac6d95e512f77b26bfe70ed', '0x08c3caa808e08ed9e5fe47cc25027bf96a4600bed9d281ad9b395cc839765302', '0x005b0d73fc9ae77205e138970022e627333bf92e79dc1b12afe5559dc3841212', '0x352a11a7aa0b7778a9ee8ef8df65c16963dab0f8baf7aaf76a9eb5424af14b7c', '0x3e48f23eb7989ba827526ce625fcbc0671adb8b8ad328fc4800941aafc3f53ea', '0x6295ff96aa53f6500c9b9e1f31abb845bb6251236af4ad2801c852b4bca47edd', '0x124be05b5000b3bec9469fdbef274eb7c4464ac3964e4ffbdce6af744470310a', '0x4124a83f863260f0e1fe1ebe2b49281fa8c6cb0163a9578d2ae8e913650ee6df', '0x21afd7f67edeb0225645d5b299c3dcaa73634c7340e8e2a58ec810449733c4b0', '0x38d93e0e6ff0592cb17acb368e595057473bd350e277bd0a7c53b483861273b8', '0x3e62031aff5ad277a4f282d72ebfa165d5214febedef2aab246f1412d58e0f90', '0x0b81d4437b44b8ea16d1ad299b1679c732916fca01ec87ff852d4f6c8e3a0b08', '0x3d200fe9160cb180457c5e553dd067bec4c2c7112380e4a2459336ec49c81737', '0x0de990ad62fe8d0b6f8381df61fa2ea256766586b9031d4a48b98732d19b41f8', '0x5e26c5ea4d3df555b1032dea1c3cde7f42f14c8e1d869475e1762115b26bf4b6', '0x51ba8d0e9b5297fe7bbabf4c2e3aab79fc12db94e0e8ea0eeac344f82fe743d9', '0x02d7baf9c37474574e0384eb16d0ad9c3811f8694864ae7845920c659eb76caf', '0x05a9736a072521ba2cc46cadd8de092cd531df68c68bacd4a45bb518c98b79f7', '0x37500400325b24c5085ed4a65d3a72e37f8e30dbd35264f58a6fc5f44e2f07b2', '0x70708499d7fd52d7fec6d86aa3be46887f5197fc4fbdf42db0ca70e06f0dbd72', '0x4f7c9a4d20cf1b14e0e2bc0a9b23300778d4dbd082bc876ac07c7c8f4d066a21', '0x1aefa1d09b8c2f9077e14d763de3120947a492d3895f3768a70cb56b8f75abdf', '0x597c5c805fd1043fd0dd6f635269b7f97f10158cc48c365143fc9538f4b9907d', '0x429d545e0b52143e082e04f4e7bbaf352725f1e6886e59ea5d828051ff159fbb', '0x1794b5fb8437d5353d4864e962f890c9ef3cf5d11a075156107452834c668fb8', '0x3542882a3f4ee5adc8d4aef41426b68bde0ad65a2897f9d7488f69ff66d916fa', '0x357f1b974dbd905118a55a552839d2ba825a294a22f934cf4a718eab0bf07705', '0x4bec733f1f0243f4040f6be2e542d631c638243a3867eb7e10ea08e8c9f27966', '0x6416a8a0c53f36b040bb7f32aec32017544b982bcc9c42eb75003f23c45c208f', '0x125710acac8da211168d46324183ee7841400562d9f29968a34f45635fc98050', '0x33ed1de9dfc00ef99d6ac40154de8b371f0bf048f01d3f392d4ab47998a99cd3', '0x64cb4e42d52480efe3c148c75b8d3031661bbeafc6edf59dcdcfda3dbe2526f5', '0x39075c55c5fbd174e4cc2fdc8ed019bf418e9ff4c714a806e928c32a2915a9e5', '0x2348397f05f8282dcc71049c814c4f04b5825112b468bef9c95f5dc2ac679f6d', '0x16fff9235e0db89a6d1adf3362417ab5adc0ec150f640298e30c42717c73abe5', '0x4187cf95fd02a204c58d1bd4640ee8d3a16aaf5834d16daafb9d84d9860c6bf4', '0x548708dc6c34e49a940c70018dc3ace19c070a93e3663eaa37ec718f14f95705', '0x27e93e8a78a488336cdb69c814aad853b0f7621d7fc22c47f2227a67947c0fa3', '0x09d154c1ee28a1cccf617a7ba1076ee30ff36e2ae7538008b6eb7b5a34e54e05', '0x414cece2513b8e57ce0432b94dcdaf18a4c40dd2777a6d988d723f64d168a380', '0x5a5bdd3491e6d9b99e3adc232b158b3e2af9427d6330426bb9937e877c1af3b7', '0x4b9d67f152e2437c2ac533574053d33eb0dc3f277f9c3fd40caea76861c29155', '0x06ac628441ed0ca9718cb004f9c2d9f726dbddd6267f088d6f4aac1a9597e05c', '0x471273a4d5e590986a5b4556001e5bd810ce5e4d03a526c5c5a6507fc1dc58a1', '0x4466a2ef32391eb944587a416a6bf183e1fc48c2a4c1d68f84bb6b82c0ff4697',
    '0x65161f66ce7349fd238b0c1176dae9ff05fa624bafeac1ca0992b60da6429a17', '0x4a35b747bfe6f9f06fcc54ad3fbcd30d5cc45bb553c86b244e8652b6ad5e037d', '0x60ff53332da8200d84156d185296f59e71da98926764bbc1361fa86a02ee46a2', '0x5b580a4e0a6777fcb38d0f7fd4d46e5a05f3683ec188d2f24b4e4f6133a098d7', '0x033c59d3d3a8934e735fd442dc30a07985fe4400b4c0420ee19e7e4ff542f873', '0x0351a1c04b83112fbcbf0aa4c1bdde39606aa7f3fd736378250ab31b1bdf4700', '0x386b9451268d0d2ebc77ef329a0f288d86e9eda3ea1e348175bdec64962f888f', '0x6adbe0bc70520a01b31a4f8ae61580ef4bd4bab7302c4a9dc0cb8a43be4a7089', '0x5651a0e7274eb16150920adaa8aa5c0c1972b598a8657edf88421feb3d190f20', '0x366e509ba6d5c6ff195863ceb1de0a752a7f077689e560fddfc91b616f75245b', '0x454e367d73336f9a7af080c97bf1b5adbc16b984abca54b18bb12b5106c8df88', '0x6f97101613e9fcc54f881f4ed7244eb113d3eb8faab03dfa7f16c77fdbf849e3', '0x4235e3312dcd17332446a932da872043c25d837d12a38790c5b773959d5524c0', '0x18860ec0216b79ad2ab2b1feb6e80245ba1bed5358341b037a206e4caf60f0e1', '0x4c630f6fa6a47a82f581fc5f73115b36c1b64fe95b52b36e812896e10ea5b1d7', '0x51ee80c83e7f8d37df7358ec89e5d3cfe4b05e9cd74fe1a705ac11ef0628ee0b', '0x581ae46c2dfd6ee53906043fda9e2996c30653ec80f5a380663d9976878b2248', '0x5308cab566d5ea01c24005a2826c3636b960c299ed33120ec16ecb7369acc9f6', '0x4b7bc018da0c9bbc5748bb82bc54cdc3d205d7fd0d6d4ad865c725b4c2db35fe', '0x2c375ce3a8e81420ee6208fe9bc667c0dbce282d80eb06148534c1211b3caee5', '0x17dfcc603135e523a51cc9153f4a99d40cbfa8e37edae1194c118c8eb04e7ac2', '0x6b4d78ea40005eb7da4323e329dc66d1c436385526c34eb49d3f8345c201204f', '0x4bb6c607053ace3501410644bcb2f6a0c8c0e4a1b08e7ee7ff15709b112b63db', '0x3db7f9e2a78dac449820129979cef6dad22dc8468269ed912fc8e4fd205c0ace', '0x69fc17a44eb1ad725d22397d36c9f4dac374c6ea7e65c8c82a8455849c60b3d7', '0x4dff04aba05be1769f51e964d9d552979e79d1a3bbc47340603af8a2410fbe2c', '0x52a3ea42507133c90611950c6d639b38f5dd838e0dc14d1d9531c5708fd9c946', '0x33f0ce40419f9efc4960466a04e8c7bbbaab0a2694a655ae096b296927b33e42', '0x63f865b7fe9df1666f40c8daacbeb2156082196f7494334f2363e5ea8bf7bdd8', '0x41a709538d5a97aea47037bf88ecbacbf4779dc09be4d0229073d9cd6a3d8b62', '0x3b35f0b7e7b55657d4dd38f2c5db9945d016bb2aef8918d11ab8eb6933bbd69b', '0x19fe7be89d14daf7044900c67edf34c8d9f48c587c7464a9712d78a7ec358e84', '0x71867b88dd4465bb904a64c490d64b02fb787a2c7702320e343a5ac06f608135', '0x16626f88c963ff6bc5c3a576a28cc46c96a8579829cc863cce9286b2e9a238e4', '0x4ee2d6f5025b7e2feb55b69fb6f9ab2ebb5d766b47043631ec7706dafc1fbf40', '0x6a09b4780cb7ec5261a4925a40a66fed101dce45192e30902faaca87fbe79df5', '0x5545760db5bdb4195c882573f7775c4fac4d2d76c00f1796127605967f20f8bd', '0x50178efd14a984d53d2f41dcfb1208fd441cd0c14c4c7ae75992b68dad503260', '0x0bc6fd3c8ddd3492c27ad7a782e37eecef81d31c48318e490ac7f5df2fec3271', '0x2f13308d7fb879596200e48d160926cfd48a2593c16be81c570ee507ff8c033c', '0x32d25b33b11900d0f11aae78b4f3b6aa63d2cabe696920289a8f27f2fa4b501a']

MDS_matrix = [['0x31fe5fea28accdbcab2a3bc67a8819ae908df150e5bd538f07c678fa1f123ab3', '0x38e2998c18f8de76b5de5e4ebddf31ddcdf2d8305a090832ac265a04f7a53817', '0x6f578f191280c6a344d9ae9a07d8c0662add1b2a66df4f91d864a6cd776b51ef', '0x5568f856c9898ad42820148335155380a60a3528eeb307d2fa476c00855aec3c', '0x70c8000065c4e06c8b0bf50d000bc3b9a19ee4c740499d9c3358a97bb2cbdb29'],['0x200400aea19dc9f67e0146ce7da37edb8d2fa29cab7950291630cfe96af15509', '0x32f3335951a3ee22968af541e1c791baf46c021ba6f6eba3686f4a29ef74a06e', '0x6c47601c0dca77621fcd74ce1ac5c4d3a0541395d2907df9a26628a0c755d258', '0x23d6a6d7ea73a7a29b9cf960d96526392b211c3fd196f38400535a3c18cddea6', '0x4de411a63d1cb3c64c0928a97675608f052aa8129e6d9e176c593ddbf158b71d'],['0x5f6693b97c810bac3010d84832b4cf758c218ca174035ff83acf944f53347d78', '0x1fa68296a604883612018b5bbd2a2ce1c246bddab558f2d5079523b1310ccc8c', '0x69580f9ffc0e266430cbaa3dcf45d4cfa284fedb7688c82aa57744786e53acca', '0x506c0e2a62805130052eb67683f436007f1b782549f5f8f5b72274c5383e4c4d', '0x1eb6e1f9e6f632f0cbfb592f1498710d5bba53b4dbfbf728581da79e862a515e'],['0x39e90820d39c1d109448966e3db925849de66d0581d556ad9e35ca1b0afa4f83', '0x67309fcda2964195423b524a95a3a947cd519bae0efe30e138cb617c3b78cb4b', '0x35e136bd3eda41957b3db59f6181176d0adea3eed275ddfab32918dba7efb07b', '0x59d2c731ee5a76476601dffcf9e797f928b99c673bd4827249c37da80863d7f8', '0x3708d64fa1a6e1513fe8186044614157b3911f68d82227e29586f182d3596f04'],['0x633650eeb9a4f1b87f1a6e5357b07d34017279adee9170ab6c93231b46f74896', '0x20fd8577d155e73cc63dcacfa765d7059b148f83100ee9ba5f628469a508b5b5', '0x0b01386d693f033fca832ac7a34b9b401030cfb68fafa594e63c62d8d8d2c7f6', '0x05eca37aeda98cc2cdbd4bb6076153dd86d943cbd4dd838e952ccf2de03acb31', '0x02db2631a8ec41935243860863f19d7a61f306cf535b608a3c20c88415ac6277']]

MDS_matrix_field = matrix(F, t, t)
for i in range(0, t):
    for j in range(0, t):
        MDS_matrix_field[i, j] = F(int(MDS_matrix[i][j], 16))
round_constants_field = []
for i in range(0, (R_F + R_P) * t):
    round_constants_field.append(F(int(round_constants[i], 16)))

def print_words_to_hex(words):
    hex_length = int(ceil(float(n) / 4)) + 2 # +2 for "0x"
    print ["{0:#0{1}x}".format(int(entry), hex_length) for entry in words]

def concat_words_to_large(words):
    int_concat = 0
    for i in range(0, t):
        int_concat |= (int(words[i]) << (n * i))
    return int_concat

def perm(input_words):

    R_f = int(R_F / 2)

    round_constants_counter = 0

    state_words = list(input_words)

    # First full rounds
    for r in range(0, R_f):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        for i in range(0, t):
            state_words[i] = (state_words[i])^5
        state_words = list(vector(state_words) * MDS_matrix_field)

    # Middle partial rounds
    for r in range(0, R_P):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        state_words[0] = (state_words[0])^5
        state_words = list(vector(state_words) * MDS_matrix_field)

    # Last-1 full rounds (no matrix multiplication at last round)
    for r in range(0, R_f - 1):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        for i in range(0, t):
            state_words[i] = (state_words[i])^5
        state_words = list(vector(state_words) * MDS_matrix_field)

    # Last round (no matrix multiplication)
    # Round constants, nonlinear layer
    for i in range(0, t):
        state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
        round_constants_counter += 1
    for i in range(0, t):
        state_words[i] = (state_words[i])^5
    
    return state_words

input_words = []
for i in range(0, t):
    input_words.append(F(i))

output_words = perm(input_words)

print "Input:"
print_words_to_hex(input_words)
print "Output:"
print_words_to_hex(output_words)

print "Input (concat):"
print "0x" + hex(concat_words_to_large(input_words))
print "Output (concat):"
print "0x" + hex(concat_words_to_large(output_words))
