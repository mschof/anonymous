# M = 128
N = 1270
t = 5
n = int(N / t)
R_F = 8
R_P = 57
prime = 0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001
F = GF(prime)

round_constants = ['0x2a4203a01c69b91a87e05f81737e9947c9e709c9c258b39a640351d11bfb77cb', '0x12778a21a8bcef8734942801eed76fd5c9a8147725f2c5ed7ee78b6fa666d05e', '0x05736eb3f41ca774b184d8a74792ed084aa6439a0fdf9639c5a69f0007096195', '0x20203b7f9860549b60496871b720b5aa67b7caf57c4b6657b3240ae94c558b70', '0x24e1f6170145af6554a9be6efc3a5064ab454b8d23b649addf8b2d3329219a23', '0x005ab2a80f5dd7638d8e87770a91193de975d32d8befb28a0c0dbbd5529eb62b', '0x20e6068aa621a9aea0215251e87c4e79fc821eaba683d2240b0565816069a18f', '0x2940d158cab8a4e391e11ab6c1b96a8a2d70c561bd4fec61be600b76b8a3793a', '0x1a7b59b0c2ca61e6ac9543e5728bb0dbd47891d50432065fec6a4f3709558623', '0x15c36dbf8c74ad2b1aa45a6eaaac52796f7cd6f530ed904ea2ee55e8c3c47ffe', '0x1a716c835a7196eee86985ffc8a47c040dae7f218a1a70c0aecb20608f5fff51', '0x2e620c63bbfdd1cba339dc310836594c3d3308ac52aadc8502e3c9ba97213f77', '0x2d94b2df002aad83ba4e46d4909e3f385aeef582aff84ee036f97a71a6eed55d', '0x26ee66d82fb3c003ba9cba18743b20b81d872dce2a845d8f70067a1d8509105e', '0x0e4d216b52f52fbaa130569cfc097cbba6923d59e25e7ebde64071d624357d53', '0x1671b91d51a06774df14ed343768f34606ca06a6ba0e2c1341ffba2df4243660', '0x1ebb1a6e6ceb54dbc737cd41d38c741b8de8a1772224386e3fc55e58de1bf8c2', '0x0dd1d372474989b25acaa59413da245b2ee11f4fc79d1a203882a5a1ea9582c9', '0x12ab9d50f0732632172e536038ae0fb5fa937fc13f807bd13fc57736759d5fdf', '0x0040b9385d351fce329c0a146817cb9d848eb6f3b83542f84080978cf6e41095', '0x2eddf9fd611dab237204a1a3bbdc8c4f395e01cba734cbc487408a25775d00d4', '0x0f852e36a5717b89b2777ceb69ab8e1df0e4b5d04bea2f34ec6e0ee73d26e028', '0x2e8fc4f9327afede9da2da09dc99409300ff5009d2aa921bb1c93f116a723b29', '0x21047373b7753422dd4291ba8291c4ae330b202367d7a7a55b1be08218eda289', '0x27eea57d22596e2b1ae231ae7c789e00291c8068ef1b8fd7f6e3bbf236ba6ef7', '0x182928cb7a3a8860a99b9008c158cd0d3f00984eb178740ebee4ae4922c02904', '0x1218ea63b3642909e4e8c4d1d8075873f52e63a27321fc11d31bcef3a98ed5a8', '0x2c3a6331d132a8a25982a9224a1679c0047057f342059b05b1f4485c84916c4e', '0x28ad585112b732de5eb655d4a9e6e42be599eb726efbb6c31a70816bc535b539', '0x030a1f76edca01aea517ae7b9008f624df147b963fc0ae697e4afcfefd3564c2', '0x047f6aff39ef4e4c412110e33ddf732b4066a3ccb5cf4497f21823e482c4ae7e', '0x0e42bf091ec89a4fa93e24d0ce6e7ea353a945cd9167ee9d466294094e0dbce2', '0x00f2386cc7151fc7eec34b9868b8d302f00828caee8f247655143dd1f87a6024', '0x2a9ab9949a37c325ce323076aa38da648e6994a13368da5e4c80013ad55b1646', '0x1877bfac19678c1c3eae5afbd524abfcab06cc0797062f01681e205b6498cb0e', '0x199e8b516658d4390830ea6de556b6fabec21115c2dfc16b432698adc5947029', '0x1aeae82c913b4c2e789041a0f56cdd958b963c9873fcb2777eecdf6afccacd9c', '0x0f73c9f76d261af2984c84124e73d83cdff421aef77c3b11bca14149f6762a05', '0x23e8b4136ec660f6b8fbad04a34f143426ab40b0cd70a22009892681c3cd1959', '0x23af1b042f22374e6ad3254b1d73ee7648498b66172958a709a2529beed8330b', '0x23dfa983a170c41693b3fcf7c042e6e530e312498aa9f8e3f823a70aade23a15', '0x1031e9e256eec1032f19402dfe48ad50eb44a981084fe4122bf649be0a320fae', '0x0bd18bad6961a19af6ed0c33b5902e481732292212bc77df0d53d0e3001e84de', '0x2403aedbf1ebe9a84c2dde607c72e2ed42b9712f2751bd66cc1034891117c77f', '0x2201f8374f6dd9434f47f3159d912ef99681d03cb0b1fece0faa4583146f4863', '0x29a9c6b0eb419e0470ece9c1666886f677213bc38dbe22206a26bd57e26ae6b1', '0x1e254a458aa9e9e1cad9b686b1b8848d38f856004a6120488499a9a8c05d4ec3', '0x112f578a044a61ae6f11b5ff65f7839d6408d84598aa807c8606a7996be3be51', '0x035c16489a595cf2f6a3e341cfff30ab15f8cafec4c2221c68a73326abbbf61d', '0x0e541b2d8a64574004ec1e394f1ef44c158e878f130176afaca0f672bf7df17f', '0x186069bdcf715a6db54a5e42d11457624e4d7b62f4cd0344ff9093bdbb6945c5', '0x0317071244c4358ed7ce39808a393f9e860cba5e8a6ef9b659dd555fc1840931', '0x11b67eee61375af42ed2ced9a04591623e357d4537325763dd2bf4af0e9fb179', '0x1f02f8e9a03a75e6d5fd2c550b3b93304e7dfbb2fdc9d677b48af720476419b0', '0x0c7e8224e8688c0b9a180e58c4e5923b492b1cac1e9bc4cfdcb2dbf43c8a8ec6', '0x11980bf8b90f6a8bd4e9a5914edbf4707d6cd8e478e09f2fd968f5d943fd8f46', '0x1db23e241ca071494ff754e38951a9b211f4b7022ed933b5cd9cf7a61c14434b', '0x02e0bac441e8981daa684813f8a6effcad681ef46a50caf69935dfb399c88ad9', '0x04f48a3774ed9d812db4c909e917e11926c280ae754c02467dae410822094ce0', '0x282ef06c9bc1e9a40506313bdf20f961d788d667f9d4f331ef9a4ee6b097d355', '0x212292b05ed0d2ba16647e9e2b351163188c98d11aadb1fba45eba238003acae', '0x02f5a6640c943f0ce594a444d9464eb31badf6e68c9b8c79520aa58e2eb6f934', '0x0de9833c37dfb66c2ae597ef6825cffb474ff35c6441fa2218bd072819e4538c', '0x2f6a0521501f49eec605856aaca26b0c8c122daf64e02efaaf3c4127ce43fd0f', '0x06ebf5b18de6ec7d4e2f0a899b1d9e53fc5bfbebf592fba2b6692d79ed81972e', '0x0718424f58be1ba5dd582bd019d4adc989a8b8e900389b85c149e08c82390559', '0x02b5d09b3a4f0618030a3efd348e679d07c4a4b243a143d67d2b6cd7f391ce77', '0x17bba55be451c3cda811d62dcfa5fc587de27fbe1549a2902d8b40891cf53039', '0x07c3d9232a41da50a264325e499321f7a24b853a91e1bc73f25a3c571ea074f5', '0x2ea8235962bcb9f942657b1f4de1702bb27e705b14e84f405322a6c4f3f1a6ae', '0x1483b15559713963689576741bec7c1e8ce0255085ba6daeee3027eaf6c81a09', '0x00a2db2f861f5c59abb455a3d651c401dafaaac581d4e6b0e80e9209484a3cdc', '0x1dbdcdbaf3ffad58c29408abc9371eedba087a19c41e35b81ccab6419f7e881d', '0x278befdc5dc0de7c286a2355c737a6813690100605e46065a91934843fd71723', '0x005b86ec3cdd2aa186ca4eca5cf5cb2af1715a8169321d135be4bcc6787974e6', '0x180a14cc10c2b66445c76729bf543deabd5d87177a25b697aa413203ff62daea', '0x063688c9699a73f998a7a98f120248173a2668c0d62ac3a4b679edc6030478e8', '0x02e9599bfdc555fbc13bc6d3fc5d9fb24b1ded534c4992bae469746bfb0b7143', '0x276cd001b0a0cb3365558da78ecae524eb71344ecedb68d2e70e5ac47e1a794f', '0x09df23a3dfb784e54f5d6b591b3828f452bd5e3ca57b3820c7888a6ee55d678c', '0x09619efc56671c6e946efe14307868b4f961b6fe2fb72773f40bf65ab3976f36', '0x1d6d8344c0803cd0fc4f327151f300b0bc71eb213912547520d4c41344bd5dc0', '0x1b715d339101a45b0faf29e8ec4c48516370abd86f9ab05eea1bec3a6d25d5dc', '0x0c38b91a55fb7d7db858ddc288b9d9c553d2a74164e157642f2e63fd3c11ddfb', '0x24f534691d22e5ef2822ed36382ef253faab87830133f37d498a7367317f3f23', '0x235f67b45d88caa5cc73070d46f154687c2228bea68440226228a20becb4d926', '0x108341e3a3f17ca0b626e8a4e4e608b82d23494ef87d54440c35c75f8ea76a35', '0x22104db41e7280d48c5cfd15890ebebe45be4845adcc345a3a4eb7e6d995c313', '0x12bf55627204aaafe0e980fa02793f878cd8a5a8664556468367337b90bb1225', '0x0cb00a249b60990a17662242ff0b60bf82ea96496150c4e52c76f38613361ff5', '0x028c4370e3d671fb4b4cacdb7633140d15a853057dd8e4be8468c3b0c941b5c3', '0x213024c1742f92b33e95b2577caf3e542d5b18e52e3fcce3950e160cd9ee7d28', '0x2f6b36e74d1db2a0292f7279b9269f533c0fc2cb5a02182cd15b29480b7e02a1', '0x1ffa58addcdcb16df353710489d59c297c038a39c7d8234177972dee57d6f046', '0x2f05da4a73c8b154603ede4b44fb5f5ea782012a5e24c7b733d21d908bf48569', '0x262efbe92fc88c0447a70e9bf83f24a1bda14d825043d8c276e601d1248e22a0', '0x16e114d0abfdb58cb13e67057e778e14496b727fde39b879cfd650f2af0ef4d5', '0x25b86bd77ed290d86a7c50af06402b541ec79669bcb978f4bdd1275d547672e6', '0x18ffb29b8b1029a941b53e733c2e84dbbe6334353e429c35f073cdc52f175ad3', '0x162488432ae2d35ca75e9c567b302e64bd59d61d137ae16342007e07c9b19124', '0x01dcb8bf79c0ba3a72214e465097e405e5eff9eba604e5fe53c2be2f99364d31', '0x13a50c79207d1f77e5ed0a0782752ad2cb763c9522aaade90d885d4294224c4a', '0x13b3c9b1ff6232ae2a961a160874cf5f8c954b20593ac8e11ad3b988dda05b6c', '0x28f19449b68e13555f7a404b2508d71a5a0c88e6c0bf467db1c580729cdb8327', '0x21a88bf2e5a554c4e86ff7dbc2408fc6b889e8f96d860d8992838ed63b68ca51', '0x23351226a631e7c8ac21718038eb427b742cf677284a88a2546a32ea994d7744', '0x0850404a973a001edfa2432c5f04832c2973938354394b688fc87b65686b9891', '0x103e40321df3d9e84dad2ef0df9d7fab963f63f5ceba4250b5e770fcff889553', '0x2bf7c231464723693cd0362037258f73d9b25ec516dd4b45e1f7297b7fee9a01', '0x10b2ca0f1c8132125ef6fde99bd3815266af4fb75afe8a7e8df5c44303737ae6', '0x08a8088482868aece115a57779130ad4fe1f612434c2f273291ac2d9c5478678', '0x0119e7df5ea572352cd0bae9411aa8fbd5bbd6ac23b2956795a983ac61d50222', '0x1e734b9e34f4bfb7a1311671e278259a4c1f75ba2b94c4f5ef6058539f8ca30f', '0x14f3c0d09fcd518930408290b56b81e518201268f41b446086f2cd108f4d1c93', '0x301b4e489149c346763e2908d07b0069dd8a9953742aed002a2413f34f9441ee', '0x12fce727824bd60bd03cd253e65873d082448cadef8ac229a8c58c3b00c7e1a6', '0x2454a7d1470b10e501bd0b8ce1c0255054ad98d0f0110d05b1205adaf1279cf7', '0x0f045f5cc4bc06544c7c26a156095677d454f7b85ef8e4ef731bb9ec361b1db9', '0x11c0c4ff3f113e9310a9bce0bc58e3afc1536ac58aaf5f1643855cbec9d57214', '0x15d0833e20b086ccee05198f47947167b676243965dfbbfe7e81fb93f4ef308b', '0x1e2ceeee30716786ff7b07d6de54cad34b5fd69eceb6bd16aac9a947d23547d7', '0x0c1f4e6dd94d1e1d269fe8d6529068248b8f56e006f8db8f34ae49f32b17aeb4', '0x029b8ba73e44e7f9c13884256108dde5a53eae62c2e6447e4f78908ef8a6d9c7', '0x2d2193ba5267ea2e171c12cd440fe3f5ba0ead10838f2f162456abea7a788171', '0x0fe3728c5c7d669a14f78241fe4b73ad95b2787eebd5fda1a4132bf26f9f5e4c', '0x05d4a05bbc41da683ff0c4eca45d6727a09931df9405d090dab192d7b4423732', '0x2080d55f427e18d312f5cf1d61791e6a06fdb293e34ec6fae0760ac88c25a2c7', '0x1fc402439fb71991d344d1d258fe3b0a319ead81f602269c084fdbd0a734d543', '0x1e81e49c5e0f367f8287ee711a5fa074e38ff8d14ebdae7167973fe32557f5ef', '0x1b1d9c37534a5ae1ad420fc85c67d72818393c9da9b91fef6e0d3d93c3af6ee0', '0x2f95a98040dfc456a16a6acae4d66367bc69ca55fd431c4b7b39287ad12fe17c', '0x0019325875eea14fb57d71d27e680de34f1c7a65ab07fb74a3a4d36110dfb07c', '0x01daef3b56f32738bf6be43d8172dca2ef24dd9e9bfcf474839b86615ed7bbb6', '0x15457fde93da515c00be80a9bb805a4eadea8de8515007618e242ac0dc0a82ce', '0x0a7bd862a610ad1f7b00d658381c258a759a704e957127682e610162d0527432', '0x063bf5b6deb5e6fb304b67c88d1ff4abbba431a5456ef97e30b3a7ee861dc0b7', '0x0c7003ad0fc9bea462a6087d14d9fa4164900ad7a59ff72c523fe743cf6b13e4', '0x29bb5f2c1ee5f5e0bfcc11d677129748fdef7318bb4c08fc0e87321f78ddd6bd', '0x1ff24ac951accd242e67560f5eee0ff2ce04aac35f226c9ae84852212d205a74', '0x15fc23a0d688d63f2eb68836f538f18f30dbd30028fa33a2e94a1ec58642029d', '0x258c81ec3fff5574de1bf9acacef96e3cc51001ecde5ada1aa4ea13a247f640e', '0x144df83786805988a4f7f83114144a15350f0daa91c77ca3e58769cb04b546f5',
    '0x18f41cc2eeec9d435a73b74ab4f59942748efa83028a19d71e9fd9dcecdea37c', '0x1166ad4b570dd3bfec9855412966357a814c93a7b1160c5721e18b2c0a11c578', '0x2ce15a3ae39d0c70eee4ec87bc9764b0b5b61e66dfe483c1a39e9265241e374a', '0x038ec4114dc9f85942ad602de75409543fb04bcc68dac9cd1d0b9c6400234e1e', '0x124570187ff0f28ab664084f20706e9f12d31819b936d89bd9e64cc1744bc053', '0x254bd02465eedcaca47675d7e7a9252ba3d90d5144bdb70adf2bc004059b57d9', '0x1afda68703d1fe58691242b48c3522db4612df7418276a16b9db4b06db811fd9', '0x1a257794778b9a84230aa9c7e16079c356140fb159844ccf2e60ee4d340d8950', '0x26fd1b5a78df1c26c62a709f718d40dc6907f7b3d084141357d955ee7d0253a0', '0x1f3da35fa68a3092b0527e981c4740ab79efafcc2b696659cfe5816468fbcf0d', '0x19a5734b23b4e0d9ae8ecf1443af0f000fe42fb98c217d99f7393e8d36e506dd', '0x28f1e6ca30346ef15fd361ada75e1898b3e8314baa40e21a891c3eb29d853120', '0x2d1dd5386fbd0132a641410fda54b9586f4b6fdad2080641db9eeaeb5b38eeb4', '0x21a920134516ee094c2cd7fe99992e5a1ede95adc6876b0103e18fedf48c0fbb', '0x20db5c10a0e6e16ee5c00985dd7edf2458c8f132039f08c1de22df2c1dca05ff', '0x0998cdd3bb9a33e7a44eed92103b4afc46b83c54a44b63f3c44883f4bec759cb', '0x14866de225fd53a2cd3bf758628a7bc2bec42fa8b465565ebc5efc7c04023b5a', '0x18c2017e8be49e3becc698c6ab1ff0067f0dfef83010cdab040828811087336e', '0x031f1c99eae7f956d2d81e90186daf0013f974c3a500fc7aa8cdbdf2d284e330', '0x110fdf9715243663929d12bffa30ae8e978fbe8e45bd282359d3fffa16970252', '0x08185bc8ab1dfeffd5f2184cf232284051403d146934c5f5f5a22d8b7da59bdc', '0x0029d2fbce4b05a503322d83dfae2c09bb5937639eb29d02bdda390467a6d23b', '0x20a4f950320c3cc75b39f69f0c15daa59f34edba75d7b6e3d1a339983541f221', '0x07918bba4febdd4901c76f5598d441d8040375145a5dc111e19690305a10c515', '0x26368d4ba1e4a576e216360b3a7bb8163c45abcbc2cfdee73a1d2469222ab9ac', '0x13259b041bb91b1cfb254e56438b279bb64e62d7a20169f978e7c84fd6d019ae', '0x1a9ad9f802e0de33fc23ff552a2d1e885a65749a34c2622be49a3ba675f332c5', '0x127b9f21c5436b654315a343b3d6d292d27f03b67be6588d24d3fe1608091a9c', '0x2f95b04cea912627589d87aa42437b1f16660da5d8b58b73282582e86a873c04', '0x13ec356500dab66968d9f2abb1883996d127927d96f99460a0c3ae639552a308', '0x19bdb2575cdab02319e36889a43069dae15f0853a2b149151a9089830a43058b', '0x0d45ea592d2bfb5be552b1a0423943a9cd2fb4f5855254aacf90b4c04e574d9f', '0x0967a710e44c56094007ef3a4230542591efaba5cd8f55555b55ffefd390489b', '0x1c16048115fb9cc23cf14bc1ccf731f483ebed39d8db76815400ae0680369a37', '0x087fc0ed2540d4c951b08d66de226b670d9eaef4d821c96cc26e8f03bf8b19bd', '0x1076cce104b686938f287389e480122fda7a83779989d279a7ee68fe7fb8243d', '0x231502fbb0088816af85349a2c9fb30370412eb3a39d4f876386619ffe833c11', '0x0393c7624992daf88dce621664e02e51ff26727f81168a88612d7d1714aea991', '0x241f86ada88846ea3d7c63cd774421198962f5a74617ddad43e35d82453559fc', '0x1b7030a1b5b87e1f9067478dca4d920fdc0491c726a4eadcc575c8cd2174ee82', '0x06b48bd54e400fcbce52f378135444b59820b6543d037ad6f357cbf4726dc34c', '0x27e56bb3b639f938b20a64ed8ff6bcd847efa6b2233921d0f44c9caea3c7865e', '0x13cf32a06656ef193b69c31e829b02797d2fe64009e5815bbd707b47eb5bc264', '0x02edf0d525d4e2ac7ba685cea9702bb537206d21366dbe5bf6944fd7e0de6a9f', '0x1a7abccfb2f3618ce10280c25e70f3bbc6929ddca6a05777d3385763b5f16698', '0x0185740ed5983d90c595c7412c56321034e1650a4cf226a0df33857320673f1d', '0x108749ec70f55267604890a0d0a996b240ed14ee19ff21f561e35450bb63c5d7', '0x0733c9e162cc17bff98a025feed5665503d62821f9894ff5f2d5bb07b0d29c47', '0x03168e3a47039595f931460d7dd0bdf77bbf72633cbead834ba526cd9d8ef0c3', '0x1d344c0e05e939c93dff9a93ac1ac99d7220de47acd1c67d258f86fd4e072450', '0x26c85ce270307cbc629459fe335076cfcafa6c050c839bab06298ac4ccdef345', '0x11003255479ac14106c4d925d3a56f2d24057d8cbcbd3626b077d9ca1df9a050', '0x2d9d06237b91b640e20f69db7dda221e52887a24b1d8ffab6583c65246b0b086', '0x0fbc0035f158ae0a26c565b555de7e4052311fcd3d94c4003d0ea461e322086b', '0x00dcb76b79b21b012b79f885a82127a8a0d12c2449b69d50421968251e020277', '0x0a31ce04df3807bf737040f225b0de5cb930115dbc793f1e18c43a7fc9e810e1', '0x249379a5a8726c664be1aab8719257f8cb24bbb6ac9c0bcf32d1defd62d063b2', '0x2ccf8d41261c4e042d3f997fbc28318feac4ac5e9357e1bdaf128374bcce3bb7', '0x25457e9ed3aa774ef021c6d4d429b425d541ce9269c11f30de534b6831a30f2c', '0x15f2b9de330fdb06344ac390a1aa4f8966b04bf93bda4dfa169e3cc24f795e88', '0x234bc841ad5599d52c0ac4853397c634e1b468cc9b16b76ca45c6008b3263f41', '0x0a701d34d5b4068bfcd08b2264b6c5b79a05bf994f1ca13a7975020386c927a4', '0x06cfa05b2b9827e105b8519c45361f04f3ebd5d414013827641dcf97511f4089', '0x04fa5d532898b51648d1553605527aa02f636afa5c7e0a758c0a3119077c76e2', '0x11eb92843628ab12dc38ee1392fddfe9b400375ee72a17f9e933ea8961ad3133', '0x23734b9dca9f7223de1945633df82cec3049341db3c95b5c4ed67a552d4f2714', '0x0b45367e8e030190b315e3c2f9b1bd1bba06c12359ea32d946c2d0449a314020', '0x0ee570d1fd24928a2bd4bca40331df18cb818e3b33efde310b18a3c2f84dfe8d', '0x218630760f1d53cce5542be9253a2e75f957458842731429b49d4ecf84f23fd7', '0x06c612bd59d3f437b2ddfb360618d30f4ed2fa8d9e384e6ea455d175e8332a37', '0x0bb9fe46228d9b4da6295242094514bf0d2830feba6917774624f8b7770d6012', '0x05fbfed8750f7c032bba42fb20b4aada85c5f66dfa13f77d944f9972df50927e', '0x1f49ea17bcd734b3f22521aa97eb607f804935441ab7ad1ae1837d8667b2eb19', '0x09692716a9d1d51832d8655d97857bde35bb417567be78fcebb8384d310b5e3d', '0x300bb03287ac82466ada0923f862fd2a9e9e2d2a3eb845404b017cc6c2edd9a4', '0x29c1d1a4f7a854473efaa659dec5a659ca8855e87686c33938cf5bde266acc85', '0x2833174608b908966d027c4afad8a0e053d05510ed44abbf48ebc5c5c3272536', '0x2cceddc380b30e9dbbe28d01bd5d3a15bbace665c3b914a6146d9141d4bb0f5e', '0x2c606cc2151a68f8ec12ad3618c7b4f7657a3b600d543df15b09a9d822e2fe6f', '0x29623bd23a50b797f2418cc55d497b88da2344e8b7a42770052562f53743f4db', '0x18d2ac404ba4ced93abc2dfacb56f436a9843be415bee1c1979242e647cf28c0', '0x0d2e328f63a27e7c21fdaeac21cf791a3a167eda0c51e55770f8765475a8beb1', '0x1346b099890b750c9db8304a95a7cea6a2704f11d27205152a91b96e4576f866', '0x14e77f0f87539e0c8bcbdf5515626d23ee4edc64be2d00c32ae71def7243046c', '0x1dd1ce79da855e0645a42dc0bbe73e8f74556bc4c963f07a8367226fdff4a531', '0x131a00e7964bebe5eae99b7ad87a0661fee4aa0de0e77e39b411408829dd1852', '0x1e7ada9fdd5a18ddfa70fa0582fbadc8aa65bfae835f925ced43bacff5801fa8', '0x03409b16f2d34d127513f27d0eacaeea78ec3072bbf263376ed8cc051b82b920', '0x1cd0cdcf9aa8a98a06610d0ff2a94002bd5ab4baa8164e8770958face1cddd03', '0x148cdaaffb41129f4abe20fdffa8aa279986e97a58330e659a2acb5723fb8658', '0x1ad5c78d0c67495842d05304eb3b1568e0b997760ec9482202eb4d29f3154379', '0x23b651b881625a5bf7303ce68284303d38bf973e46999a51e7dae5fb3e038a75', '0x0dce63657915fa951dcd53f536c0e6534ca0687311addb3737957e197a93058f', '0x249da198ce1f7b05a7f61b24800701a5c8245e1733fe7d3779c6d09b51990b17', '0x06be2b6ef6a6934810322e13468f335429929126f3026ec05629aeabf174e9d6', '0x2817ec7734f2af551445863fed4744b92a30f7770b08071934313daab94b1d22', '0x27376994841203aa0cb9620861cb4ced2b97ca426a9292303ea50fb142d18144', '0x241cb723939f0fb52d3b12ad8048b2f0715e169e20877c0c6295e10505be4f78', '0x2e04975a81912f158ba6f684cdffed97371323e41de423fa83fa4894f7919d9e', '0x2aec70519a64b447b40d1563f57ebc630d69a80fb392e3181e62e47cad97081c', '0x049f5d83a1c7750ac55888696cd58099e273c50e0e341f88ac719d21a480c72b', '0x0c99ebb9c12676e209618cb55c70640df9b27c0ad7691efc5e970394f2feb7f0', '0x0d7c6c63b913c1a5137f73fda60ba0f634396184e99748427a570aabbcf9b6bf', '0x1573b26e82bf20b782cd41c70e189efcaddc3c9230064972bb98cbce9b131240', '0x1e7a06c0fb0200482f0b07abe527477014a9a605ead8c58bafdf9a15ea0d2aab', '0x1818d44133877835a3bf7b20e37e4a103828513de386cfe1c6a5b79daccc71ba', '0x2e7a9988cef99a56d93cf122e58b80768137a4fc55218f211945584f96b80cd2', '0x07bc907828beea6b983b7ee8811671a987138f38c33b8b667a012cf3ce9c6d1a', '0x10ece06aaed8ceb1ee37f7d0231cfa7586c40dbbbdf79c9e88a32abbfe0c8158', '0x1df72c40981ab22f12528dc0507ec5e67336e388f9a93529f3376b7efabfad40', '0x0bc7931cbaecf22048e43a0b741ea03f39db9b5502ec9868d17b921730818817', '0x1e19fbf8f0bc0c3285257f500a4a8e03590c9ec2fa8092693519b9d18cf5e665', '0x0e1d3ec0eeed7e70574932421c3e6291e44003520dd1f58c4a897a938b4bffb5', '0x1c124f8c223282e76d78e279ef90c005bc4e09b0d2352bf1a34f2ff8dfb21563', '0x0390f181e994709747755f79251c15d25eda3fda2859a18221a8abbf43f3182b', '0x1e16419a1d138df66909cceae8e6441451884a6e8521830ed842123e6dd5f409', '0x055078b832d838713de82dd6bb1bce3aed52645328db9d5bd71665273a907395', '0x0a930de0e7e00ebb7af6d4a51d270624e409f41944adb8e727350910d0c4ca73', '0x1e3ece3934f43a3fc219fb3e441193cffea33876ebd70dbe78047eb168713fcf', '0x241425ec266eb4c3cb34130d4c301a4dd8e5d47b47a07821bd1180c4c76fcccc', '0x1471162c06a02c52d0bb09fb9b3965b969f923e0edabee377a4afb94eeb8be1b', '0x1b3c129e4189e73aff0deecadf6eb91820463a59ade25f680220d84cdc3121f4', '0x138ec2c70806e929adbda483254ce74a8ffdab8d8b0da34f82cbf3aa9e84901b', '0x1e2192e18e75266b29225460fb2de175222057a0908ce4cb23eeaaa6d22c632c', '0x22f500abc0fdd2fe4be2040e5ec6148b877084d30e42bfcf9dac8de46f420195', '0x2cab006c90ff5251578ec71755ed6f2639f117be81b583665c5676a31d32bfcd', '0x00afc0b777e9bb43a912086cd7a94c9e2222cdb7d0570b63b6b9dc1d3504beee', '0x07b2cafa939671623c18005f654645b8c8e62dcadd499f724947949a2e825b0b', '0x2851594f588ee76edff8fd6d34286fe3b27fe66111a36b0011d2b37eb4a7eb83', '0x1bf383b0ccd3f981015fe5525193a8c590444339e0b3f6f37ccbe0e7d92ec3c1', '0x06b3738bc99127f1ac9e1fa4811a0e11ab0212e68a32dffd35a0ea8a90922b71', '0x0958d759ac536d99bcd23182a269cbdb5195041eff0e3c405d2c20b7855ca33b', '0x2121efd2aa3fd53411d511068d682af50b338074abfc8a5a130b13b58211554d', '0x1625cfe49ac540d54582f8a913ac2a4c694b4b218856540c9349bbb700546ed6', '0x25c40685f4850d37bba5ae77d6ca1cfa2cbba787580b0858fff3cf8eda9ffdde', '0x0274e533cb6eebfe832cbe703f633c94aadc1c57d09b78df7d228d5cdb7fc123', '0x038d24a494e899ff1a7e92d3129bfb397ea3877e3bd4f3c93fafa68a85ab0748', '0x1e807d69ba0b0bf07715a03aa91c5af7c8f65d25bf6c1df0bd2c55ae54930388', '0x2ede43da7c2da9b7f0bf2b1ec6835e7a2a23f1306c3bfebe94416d48dd9b0296', '0x1d620493e3754db238bffc125e4911ef21c90c35c5ec342f5dcd1c584c9a7097', '0x263f8a85ea2bd71fbad8b4ae8eb21e83a3f3475361eca0094f511e4f5844e7a1', '0x26d20965f0c72b6ef7310ea2f6855b3de400aa47db68dc8b55735de4c3975ede',
    '0x1fdbb7745d3aaa1be5b39f8e4336c6b387d0cc782b9110f48cb9fa3c426ea3d4', '0x06e5ae85175f757251e76d940b2a3c4907026b0e63639a41a056ae5612ce99ec', '0x07236523a052663ce2ef9184a61ed4bbdea675cbe21b877a9d312cfb42d56a47', '0x22b936bb858a9c5b48c66a3460f46c17cf2ff29b164c54372124a6d7ef0fbbaa', '0x1949517a9e3e4cda335f3ba53186e252a027caf56500b9a1d8fe4e312bde9d9b', '0x1641e46a11d102583ac5c01f149d40e5122be034f310584f918ed4fdd2a68ce3', '0x05676a48030a0ab3cb5a038eae9e97496bbb6e2f9c0e47f926f5bf028f40b29a', '0x1eb47b530ec1129e4dc78b740fd4222a21bfbeafd1bb93d183a1b54358bff4a6', '0x2002c50a17179000f0cb86608ea2c0b6891103b45db116b8628bdfbf2f3f3f81', '0x05bfd86dd5cb799648fa66fd7165b31cdf103e9a57959aaf814b88c8203e5653', '0x1619cfab9cc10f5a826042b92709a62689650d661c6aac0bddece102e2736436', '0x0165026edfeda7c54dd8f9f59d4da73219d94e1bf0be3b16ff9dad676c2d8ff0', '0x30449a352c3dc241054b216f29dd2941905a4d13337c9eac940f8723e7db0fff', '0x0f80862823c4ff4cf2b08166f8358c4b0b466bd2529acc74bcc6ede4bedf116a', '0x2d252b9d1f026a61964a235ec6c863894e227b3094d221c9c760f86edb72f9a2', '0x2c62a3b0dfd442c28433d17b82ac76ac7bc4ac10138e3acd2897e4e400dbc27d', '0x0f35a513aa517c324288167753d61c14ec68692f93f601fcdb88970cdd01213e', '0x301cde18df496332d7be9bd936351fdf36a6720e9b1a483dd1214b8a8fb1a4ff', '0x238b3cddf49235ec0d490e5e9c4f40d22868cbc6b80c851d24f48c6faff0c5d4', '0x25232b8c079b66a22410db996ff3fcb5ff05e1258170d484ce5d71a77b5220f9', '0x0c2a260db843369de272aaba76321ad01252f09a181bb7c94bc6042bffc83f34', '0x1f98ca69aaf18d589c99a4f61ebec0423455ba16e5660c4fee7586d5899ea511', '0x0b58ced32356b756d82e3b2ad036f3d89dc5b5a227b1cafb0aea75df610aeafc', '0x0e72b3877dce8e328728dfd8436366bfef03f82154b24ba7e88473e68681ff4d', '0x2e510394c1f487a8138f7569bd42af174464a4e15f6b2a5dd6a7ba8380d3a082', '0x234b37eab6a2b9b1b840b237dda691d9d9afbaa71696f4095ec43c62692298bb', '0x0b1607e4729e8f012a46466d90a393479c87377d8ca1526e40f234753d59aac2', '0x1eb8ca5f2ac3b7882399884fe2c7cbf7628130c22f30ab0c738c9256946b8402', '0x26bdf5a0108b8931caa13bf11e7d53a4bc0b564becaf4a8b3d5d5b0784378f85', '0x0c2dbf5b54133b80e0cab22530deb8c8c97a6aa68f32ea39e0ab8db4a2b4b34e', '0x2b916bf8eb6d45945b2c10e6496334a9efbd2f2702299b9399450e173fc9e158', '0x11b9c1d4d5ffca7e8cb611b1080fa03ec22e7192683afdb8c61bc101263624fa', '0x2f35c32ac897bd67ee97f2f0a9fb422ce6e05f7f2b5c51eec518c402c5528fa1', '0x21bff87d5596c946ffca63e1a42d478ec28e2769793cfd0b1163c5cd958d26e1', '0x1fd3be018473cdf3f61a605de7277ff7fd44cc716f562791112c757a0185c93a', '0x183fddb7c25a8ca0835d1c9edc68d2bfbd15e105565cbe2d90ea965aeaed2d68', '0x0d1ae8055f4ce61059d5d4f0e8c5884d2c61ca3712be9d2368df1cf6a330cebd', '0x172b04cf448e4a6be71e31cc899097d8c8f5dd6f41bfb0e75af136227a1e8898', '0x233920e8882315be5ac4057b82183de4c3305414d8bf23d1c6cb062993e49bcf', '0x23897105811f250ce1a21a0dd7bcebf625e854b2542357fa340b01d92f725ec1', '0x01b1a4cd5810fb8c18d56fff181c479777c8f4d07bdd5d5138e355a02b13f1a3']

MDS_matrix = [['0x14c2c125fbdfebb54922baf600a990c07624f037cd6344cc2f5cac0c46a8858b', '0x1e61a991cafbf9b1fffecabbff259273d4f216fa776bdc1bf30a8abe179e5ba6', '0x0a68a805b14740f577009e6681ecfad3071cbe804a03c673da19fa958a0eb5b0', '0x0196a18b49b9c7ab4e030f1981ef1cfe9d9fe005b4b82a32aff1d7f537f61c15', '0x0a4d23c3ee2be3ff6bf10cf2f6bb010d79fec8b2603e6ea90f2becbf48a71282'],['0x274121709880b0745a79353d105420adc4df4b7d9f2b33844aee0aa42fd9d3fe', '0x1f341051b4bb60e0c90c65b1f24464be353612fbec70c066f1ffdf3f2550e416', '0x18e6853fac668c28e577b940c5ec01326cea4201929ce427a2ee324fdfccf4e9', '0x12fa9d156c013d66cc90b99e1b8490ceec00fe7788a10e5c9da6cd7112a8cdbe', '0x18f60e5d0ede2674444265b78d361134f46f162a48131df61bbd6319b17f5e81'],['0x2fae02cb901776787cba0f42d091f6a39de79f4e20ba998d77aa33852561f19f', '0x15b0b29867f63fed30dac4f8b5a53ad3825fb99590909624934a778d7784124a', '0x159e268664b501d132f24cf087060ae2406ad9d28249f240d3454c1e77299a5b', '0x15f3c095ce3d929604efb7bb0365b22682cf482a48910e8250e81fd0ed3640a0', '0x0596a597bc83bbb05c2c717ae2707278bd7b5c1524e7d33e85084d26d79d5599'],['0x2940d36958336710e015e4b879465e4de5e6a0cfebeb01e080e581b24cc189ea', '0x0fba46a155d79ef17862ba7848353e383067712aab072cffc7ef64e502d15262', '0x2307db0610ef85a1272ba4ae7dfaee72c27dc608c793238e97e173a2cc86903f', '0x22686d88be79325e51e0797462e666f86859a2a8455fa3b51a9ec80937f6767b', '0x2519312e1269b5d9e6296a5b7050833a614ad4dc851bb4a65dbe9c84b04a29e2'],['0x2d896e2a7a15528327c24dc21c07ceab063bee65eeec5a379f89973a6d23af18', '0x17903fd85d755ed9741b8d9a84c584cd9a52f34d46f136427205140d215c7392', '0x283704a1c88748218500691e654d4f8393f41d61258b777d216765cf5335788d', '0x2fd95528fa21fe1e1d27da13e4cf00e41563f56f2a05b9e704a15696ef7de1f9', '0x069f86f70eaecb1f230846381b99db25c0fd9951368d5680c9087c41c2e2b203']]

MDS_matrix_field = matrix(F, t, t)
for i in range(0, t):
    for j in range(0, t):
        MDS_matrix_field[i, j] = F(int(MDS_matrix[i][j], 16))
round_constants_field = []
for i in range(0, (R_F + R_P) * t):
    round_constants_field.append(F(int(round_constants[i], 16)))

def print_words_to_hex(words):
    hex_length = int(ceil(float(n) / 4)) + 2 # +2 for "0x"
    print ["{0:#0{1}x}".format(int(entry), hex_length) for entry in words]

def concat_words_to_large(words):
    int_concat = 0
    for i in range(0, t):
        int_concat |= (int(words[i]) << (n * i))
    return int_concat

def perm(input_words):

    R_f = int(R_F / 2)

    round_constants_counter = 0

    state_words = list(input_words)

    # First full rounds
    for r in range(0, R_f):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        for i in range(0, t):
            state_words[i] = (state_words[i])^5
        state_words = list(vector(state_words) * MDS_matrix_field)

    # Middle partial rounds
    for r in range(0, R_P):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        state_words[0] = (state_words[0])^5
        state_words = list(vector(state_words) * MDS_matrix_field)

    # Last-1 full rounds (no matrix multiplication at last round)
    for r in range(0, R_f - 1):
        # Round constants, nonlinear layer, matrix multiplication
        for i in range(0, t):
            state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
            round_constants_counter += 1
        for i in range(0, t):
            state_words[i] = (state_words[i])^5
        state_words = list(vector(state_words) * MDS_matrix_field)

    # Last round (no matrix multiplication)
    # Round constants, nonlinear layer
    for i in range(0, t):
        state_words[i] = state_words[i] + round_constants_field[round_constants_counter]
        round_constants_counter += 1
    for i in range(0, t):
        state_words[i] = (state_words[i])^5
    
    return state_words

input_words = []
for i in range(0, t):
    input_words.append(F(i))

output_words = perm(input_words)

print "Input:"
print_words_to_hex(input_words)
print "Output:"
print_words_to_hex(output_words)

print "Input (concat):"
print "0x" + hex(concat_words_to_large(input_words))
print "Output (concat):"
print "0x" + hex(concat_words_to_large(output_words))
